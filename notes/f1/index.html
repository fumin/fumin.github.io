<html>
  <head>
    <meta charset="utf-8"/>
    <script id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    <style>
a {
  color: gray;
  text-decoration: none;
}
a:hover {
  text-decoration: underline;
}
a:focus {
  text-decoration: underline;
}
a:active {
  color: yellow;
}
    </style>
  </head>
  <body style="background-color: black; color: white; font-size: xx-large;">
    <div id="container" style="margin-left:auto; margin-right:auto; text-align: center;">
      <h1>F1 car spoilers</h1>
      <img id="img" src="f1.jpg" style="">
      <p>
        The spoilers on the two cars above have different shapes.
        The left car's spoiler is an ordinary rectangle, whereas the right spoiler has receding concavities at its bottom left and right corners.
      </p>
      <h3>Which design is better?</h3>
      <div id="standard-mesh">
        <iframe src="standard_mesh.html"></iframe>
        <div>Standard design</div>
      </div>
      <div id="curved-mesh" style="margin-bottom: 2em;">
        <iframe src="curved_mesh.html"></iframe>
        <div>Curved design with receding concavities</div>
      </div>

      <h2>Answer</h2>
      <p>The curved design is on the whole better.</p>
      <p>
        The table<sup id="cite_ref-1"><a href="#cite_note-1">[1]</a></sup> below shows that the curved design reduces the drag considerably at the expense of only a slight decrease in down-force.
        This suggests that the curved design is better than the standard one.
      </p>
      <table style="margin-left: auto; margin-right: auto; border-spacing: 1em 0; font-size: xx-large;">
        <thead>
          <tr style="font-weight: bold;"><td>Force [\(kg\cdot m/s^{2}\)]</td><td>standard</td><td>curved</td></tr>
        </thead>
        <tbody>
          <tr><td>Drag</td><td>34.984</td><td>31.308</td></tr>
          <tr><td>Down-force</td><td>21.635</td><td>20.257</td></tr>
        </tbody>
      </table>

      <p>
        The diagrams below show the Computational Fluid Dynamics results.
        Plots on the surface of the spoilers show the pressure.
        We see that the pressures on top of both spoilers are larger than their bottom counterparts, confirming the intuition about the spoilers providing additional down-force that help stabilize the vehicle.
      </p>
      <p>
        Plots along the drag direction show the turbulent kinetic energy.
        We see that the curved design results in less turbulent flow, reaffirming its superiority over the standard design in terms of both speed and stability.
      </p>
      <div style="position: relative;">
        <iframe id="standard" src="standard.html" style=""></iframe>
        <div>Standard design. This is a 3D interactive graph. Use <i>Shift+Mouse</i> to pan; <i>Mouse</i> to rotate, and <i>scroll</i> to zoom.</div>
      </div>
      <div style="position: relative; margin-top: 1.5em;">
        <iframe id="curved" src="curved.html" style=""></iframe>
        <div>Curved design. This is a 3D interactive graph.</div>
      </div>

      <h2>Reference</h2>
      <ol style="text-align: left;">
        <li id="cite_note-1">
          <b><a href="#cite_ref-1">^</a></b> Note that from the table above, we can also infer how much engine power is spent on countering the drag induced by the spoilers.
          The calculations were done under a speed of \(10m/s\), which for the standard spoiler implies the power consumption is \((34.984N)\cdot (10m/s)/(735.5hp/W) = 0.476hp\).
          Assuming F1 cars race at \(200km/hr\), the power consumption at such speeds is \((0.476hp)\cdot ((200km/hr)/((10m/s)*3.6))^{3} = 81.619hp\).
          Typical F1 engines produce roughly 1000 horsepower, therefore we conclude about \(81.619/1000 = 8\%\) of the power produced is spent on combating the drag induced by spoilers.
        </li>
      </ol>
    </div>

    <script>
function onWindowResizeContainer() {
  const container = document.querySelector("#container");
  if (document.body.clientWidth/document.body.clientHeight > 1024/768) {
    container.style.width = "70%";
  } else {
    container.style.width = "100%";
  }
}

function onWindowResizeImg() {
  var ref = document.body;
  var mTop = parseInt(window.getComputedStyle(ref).marginTop, 10);
  var mBottom = parseInt(window.getComputedStyle(ref).marginBottom, 10);
  var mLeft = parseInt(window.getComputedStyle(ref).marginLeft, 10);
  var mRight = parseInt(window.getComputedStyle(ref).marginRight, 10);
  var maxW = ref.clientWidth-mLeft-mRight;
  var maxH = 0.5 * (window.innerHeight-mTop-mBottom);

  var el = document.querySelector("#img");
  var w = el.width;
  var h = el.height;
  var wdh = w / h;
  if (w > maxW) {
    w = maxW;
    h = (1/wdh) * maxW;
  }
  if (h > maxH) {
    h = maxH;
    w = wdh * maxH;
  }
  
  el.style.width = w;
  el.style.height = h;
}

function fullscreenIFrame(el, div){
  if (!div.fullscreen) {
    div.fullscreen = true;
    div.oriPosition = el.style.position;
    el.style.position = "fixed";
    div.oriTop = el.style.top;
    el.style.top = 0;
    div.oriLeft = el.style.left;
    el.style.left = 0;
    div.oriWidth = el.style.width;
    el.style.width = "100vw";
    div.oriHeight = el.style.height;
    el.style.height = "100vh";
    div.oriZindex = el.style["z-index"];
    el.style["z-index"] = 999;
  } else {
    div.fullscreen = null;
    el.style.position = div.oriPosition;
    el.style.top = div.oriTop;
    el.style.left = div.oriLeft;
    el.style.width = div.oriWidth;
    el.style.height = div.oriHeight;
    el.style["z-index"] = div.oriZindex;
  }
}

function onWindowResizeCFD(selector) {
  const el = document.querySelector(selector);
  const w = el.parentElement.clientWidth;
  const h = el.clientHeight / el.clientWidth * w;
  el.style["width"] = w;
  el.style["height"] = h;
}

function onWindowResizeMesh() {
  var standardMesh = document.querySelector("#standard-mesh");
  var curvedMesh = document.querySelector("#curved-mesh");
  const docW = window.innerWidth;
  const docH = window.innerHeight;
  if (docW/docH > 1024/768) {
    standardMesh.style.width = "50%";
    standardMesh.style.float = "left";

    const standardIFrame = standardMesh.querySelector("iframe");
    var w = standardMesh.clientWidth * 0.9;
    if (w > standardIFrame.clientWidth) {
      const h = standardIFrame.clientHeight / standardIFrame.clientWidth * w;
      standardIFrame.style.width = w;
      standardIFrame.style.height = h;
    }

    curvedMesh.style.width = "50%";
    curvedMesh.style.float = "left";
    curvedMesh.style["margin-top"] = "0";

    const curvedIFrame = curvedMesh.querySelector("iframe");
    w = curvedMesh.clientWidth * 0.9;
    if (w > curvedIFrame.clientWidth) {
      const h = curvedIFrame.clientHeight / curvedIFrame.clientWidth * w;
      curvedIFrame.style.width = w;
      curvedIFrame.style.height = h;
    }
  } else {
    standardMesh.style.width = "";
    standardMesh.style.float = "";
    curvedMesh.style.width = "";
    curvedMesh.style.float = "";
    curvedMesh.style["margin-top"] = "1em";
  }
}

function handleWindowMsg() {
  window.addEventListener("message", function(e){
    const splitted = e.source.location.pathname.split("/");
    const base = splitted[splitted.length-1];
    if (base == "standard.html") {
      const standard = document.querySelector("#standard");
      fullscreenIFrame(standard, standard);
    } else if (base == "curved.html") {
      const curved = document.querySelector("#curved");
      fullscreenIFrame(curved, curved);
    } else if (base == "standard_mesh.html") {
      const standard_mesh = document.querySelector("#standard-mesh iframe");
      fullscreenIFrame(standard_mesh, standard_mesh);
    } else if (base == "curved_mesh.html") {
      const curved_mesh = document.querySelector("#curved-mesh iframe");
      fullscreenIFrame(curved_mesh, curved_mesh);
    }
  });
}

function main() {
  onWindowResizeContainer();
  var imgEl = document.querySelector("#img");
  imgEl.addEventListener("load", function(e){
    onWindowResizeImg();
  });
  onWindowResizeMesh();
  onWindowResizeCFD("#standard");
  onWindowResizeCFD("#curved");
  handleWindowMsg();
}
main();
    </script>
  </body>
</html>
