<html>
  <head>
    <meta charset="utf-8"/>
    <script id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    <style>
a {
  color: gray;
  text-decoration: none;
}
a:hover {
  text-decoration: underline;
}
a:focus {
  text-decoration: underline;
}
a:active {
  color: yellow;
}
    </style>
  </head>
  <body style="background-color: black; color: white; font-size: xx-large;">
    <div id="container" style="margin-left:auto; margin-right:auto; text-align: center;">
      <h1>F1 car wings</h1>
      <img id="img" src="f1.jpg" style="">
      <p>
        The wings on the two cars above have different shapes.
        The left car's wing is an ordinary rectangle, whereas the right wing has receding concavities at its bottom left and right corners.
      </p>
      <h3>Which design is better?</h3>
      <div id="standard-mesh">
        <iframe src="standard_mesh.html"></iframe>
        <div>Standard design</div>
      </div>
      <div id="curved-mesh" style="margin-bottom: 2em;">
        <iframe src="curved_mesh.html"></iframe>
        <div>Curved design with receding concavities</div>
      </div>

      <h2>Answer</h2>
      <p>The curved design is on the whole better.</p>
      <p>
        The table below shows that the curved design reduces the drag considerably at the expense of only a slight decrease in downforce.
        This suggests that the curved design is aerodynamically more efficient than the standard one, as measured by the lift-to-drag ratio.
      </p>
      <table style="margin-left: auto; margin-right: auto; border-spacing: 1em 0; font-size: xx-large;">
        <thead>
          <tr style="font-weight: bold;"><td>Force [\(kg\cdot m/s^{2}\)]</td><td>standard</td><td>curved</td></tr>
        </thead>
        <tbody>
          <tr>
            <td>
              Drag
              <sup id="cite_ref-1"><a href="#cite_note-1">[1]</a></sup>
            </td>
            <td>34.912</td><td>31.227</td>
          </tr>
          <tr>
            <td>
              Downforce
              <sup id="cite_ref-2"><a href="#cite_note-2">[2]</a></sup>
            </td>
            <td>21.679</td><td>20.314</td>
          </tr>
        </tbody>
      </table>

      <p>
        The plots below show the Computational Fluid Dynamics results.
        Colors on the surface of the wings show the pressure.
        We see that the pressures on top of both wings are larger than their bottom counterparts, confirming the intuition about the wings providing additional downforce that help stabilize the vehicle.
      </p>
      <p>
        Colors on the slice of the air flow show the turbulent kinetic energy.
        We see that the curved design results in less turbulent flow and thus more retained energy in the region behind the wing.
        More energy leads to higher dynamic pressure, which translates into less pressure difference between the front and back parts of the wing.
        Less pressure difference implies a smaller drag.
      </p>
      <div style="position: relative;">
        <iframe id="standard" src="standard.html" style=""></iframe>
        <div>Standard design. This is a 3D interactive graph. Use <i>Shift+Mouse</i> to pan; <i>Mouse</i> to rotate, and <i>scroll</i> to zoom.</div>
      </div>
      <div style="position: relative; margin-top: 1.5em;">
        <iframe id="curved" src="curved.html" style=""></iframe>
        <div>Curved design. This is a 3D interactive graph.</div>
      </div>
      <div style="position: relative; margin-top: 1.5em;">
        <img src="force.svg" style="border-style: solid;">
        <div>Pressure components for the front/back and top/bottom surfaces<sup id="cite_ref-3"><a href="#cite_note-3">[3]</a></sup>.</div>
      </div>

      <p>
        Besides turbulence, downforce can also be lost when air flows sideways at the tip of the wing instead of hitting straight onto the front of the wing.
        Such sideways leakage results in rotational air movement behind the wing.
        Reducing these wingtip vortices would recover the lost downforce, and thus improve aerodynamic efficiency.
        The below animations show streamlines of air particle trajectories for both wing designs.
        We can see strong vortices being created whose elimination should the objective of future design optimizations.
      </p>
      <div style="position: relative;">
        <iframe id="standard-stream" src="standard_stream.html" style=""></iframe>
        <div>Standard design. This is a 3D interactive graph. Use <i>Shift+Mouse</i> to pan; <i>Mouse</i> to rotate, and <i>scroll</i> to zoom.</div>
      </div>
      <div style="position: relative; margin-top: 1.5em;">
        <iframe id="curved-stream" src="curved_stream.html" style=""></iframe>
        <div>Curved design.</div>
      </div>

      <h2>Reference</h2>
      <ol style="text-align: left;">
        <li id="cite_note-1">
          <b><a href="#cite_ref-1">^</a></b>
          Note that from the table above, we can also infer how much engine power is spent on countering the drag induced by the wings.
          The calculations were done under a speed of \(10m/s\), which for the standard wing implies the power consumption is \(P_{table} = F\cdot v = (34.984N)\cdot (10m/s)/(735.5hp/W) = 0.476hp\).
          F1 cars can reach top speeds of over \(300km/hr\), for these speeds the power consumption is \(P_{table}\cdot (\frac{v_{F1}}{v_{table}})^{3} = (0.476hp)\cdot ((300km/hr)/((10m/s)*3.6))^{3} = 275hp\).
          Typical F1 engines produce roughly 1000 horsepower, therefore we conclude about \(275/1000 = 27.5\%\) of the power produced is spent on combating the drag induced by wings.
          <br><br>
          Using this data, we can further deduce the total drag under further assumptions about the dimensions of a real F1 chassis.
          Under the latest specifications, F1 chassis typically have width \(2m\) and height \(0.95m\).
          On the other hand, the area of the wing is \(1m^{2}\), and since the wing is at a \(45deg\) angle, the cross section is \(1m^{2}\cdot cos(45deg) = 0.707m^{2}\).
          Therefore, the total drag is \(D_{wing}\cdot \frac{A_{chassis}}{A_{wing}} = (27.5\%)\cdot \frac{2m\cdot 0.95m}{0.707m^{2}} = 73.9\%\) of the engine's power production.
          In other words, under top F1 speeds, aerodynamics should be a car designer's most important concern.
        </li>
        <li id="cite_note-2" style="margin-top: 1em;">
          <b><a href="#cite_ref-2">^</a></b>
          We can calculate the downforce in a real F1 race from the data here, assuming a top speed of \(300km/hr\).
          Since the data here is done under a speed of \(10m/s\), the downforce in a real race is \(F_{F1} = F_{table}\cdot (\frac{v_{F1}}{v_{table}})^{2} = (21.635N)\cdot (300/(10*3.6))^{2} = 1502N\).
          A typical F1 chassis weighs \(740kg\), thus the wing adds \((1502N/9.8)/(740kg) = 20.7\%\) to the car's grip.
          Moreover, a typical F1 chassis has length \(5.5m\) and width \(2m\), therefore the downforce of the entire chassis is \(20.7\%\cdot (5.5m\cdot 2m) / (0.707m^{2}) = 322\%\).
          We conclude that the downforce of a F1 car is substantially larger than its own weight, implying that they could theoretically drive upside down in a tunnel.
        </li>
        <li id="cite_note-3" style="margin-top: 1em;">
          <b><a href="#cite_ref-3">^</a></b>
          The below tables show the pressure forces on each face of both designs.
          <table style="margin-left: auto; margin-right: auto; border-spacing: 1em 0; font-size: xx-large;">
            <caption>Standard</caption>
            <thead style="font-weight: bold;">
              <tr><td>Face</td><td>Lift \((N)\)</td><td>Drag \((N)\)</td><td>Area \((m^{2})\)</td></tr>
            </thead>
            <tbody style="text-align: right;">
              <tr><td style="text-align: left;">Front</td><td>-11.0647</td><td>11.0694</td><td>0.5001</td></tr>
              <tr><td style="text-align: left;">Back</td><td>-17.3586</td><td>17.0596</td><td>0.5001</td></tr>
              <tr><td style="text-align: left;">Bottom</td><td>-1.3114</td><td>-1.2667</td><td>0.0989</td></tr>
              <tr><td style="text-align: left;">Top</td><td>8.0567</td><td>8.0494</td><td>0.0999</td></tr>
              <tr><td style="text-align: left;">Right</td><td>-0.0012</td><td>0.0004</td><td>0.0499</td></tr>
            </tbody>
          </table>

          <table style="margin-left: auto; margin-right: auto; margin-top: 1em; border-spacing: 1em 0; font-size: xx-large;">
            <caption>Curved</caption>
            <thead style="font-weight: bold;">
              <tr><td>Face</td><td>Lift \((N)\)</td><td>Drag \((N)\)</td><td>Area \((m^{2})\)</td></tr>
            </thead>
            <tbody style="text-align: right;">
              <tr><td style="text-align: left;">Front</td><td>-10.5092</td><td>10.5122</td><td>0.4992</td></tr>
              <tr><td style="text-align: left;">Back</td><td>-15.2332</td><td>15.2903</td><td>0.5002</td></tr>
              <tr><td style="text-align: left;">Bottom</td><td>-0.3371</td><td>-0.3338</td><td>0.1036</td></tr>
              <tr><td style="text-align: left;">Top</td><td>5.7584</td><td>5.7577</td><td>0.0989</td></tr>
              <tr><td style="text-align: left;">Right</td><td>0.0075</td><td>0.0003</td><td>0.0400</td></tr>
            </tbody>
          </table>
        </li>
      </ol>
    </div>

    <script>
function onWindowResizeContainer() {
  const container = document.querySelector("#container");
  if (document.body.clientWidth/document.body.clientHeight > 1024/768) {
    container.style.width = "70%";
  } else {
    container.style.width = "100%";
  }
}

function onWindowResizeImg() {
  var ref = document.body;
  var mTop = parseInt(window.getComputedStyle(ref).marginTop, 10);
  var mBottom = parseInt(window.getComputedStyle(ref).marginBottom, 10);
  var mLeft = parseInt(window.getComputedStyle(ref).marginLeft, 10);
  var mRight = parseInt(window.getComputedStyle(ref).marginRight, 10);
  var maxW = ref.clientWidth-mLeft-mRight;
  var maxH = 0.5 * (window.innerHeight-mTop-mBottom);

  var el = document.querySelector("#img");
  var w = el.width;
  var h = el.height;
  var wdh = w / h;
  if (w > maxW) {
    w = maxW;
    h = (1/wdh) * maxW;
  }
  if (h > maxH) {
    h = maxH;
    w = wdh * maxH;
  }
  
  el.style.width = w;
  el.style.height = h;
}

function fullscreenIFrame(el, div){
  if (!div.fullscreen) {
    div.fullscreen = true;
    div.oriPosition = el.style.position;
    el.style.position = "fixed";
    div.oriTop = el.style.top;
    el.style.top = 0;
    div.oriLeft = el.style.left;
    el.style.left = 0;
    div.oriWidth = el.style.width;
    el.style.width = "100vw";
    div.oriHeight = el.style.height;
    el.style.height = "100vh";
    div.oriZindex = el.style["z-index"];
    el.style["z-index"] = 999;
  } else {
    div.fullscreen = null;
    el.style.position = div.oriPosition;
    el.style.top = div.oriTop;
    el.style.left = div.oriLeft;
    el.style.width = div.oriWidth;
    el.style.height = div.oriHeight;
    el.style["z-index"] = div.oriZindex;
  }
}

function onWindowResizeCFD(selector) {
  const el = document.querySelector(selector);
  const w = el.parentElement.clientWidth;
  const h = el.clientHeight / el.clientWidth * w;
  el.style["width"] = w;
  el.style["height"] = h;
}

function onWindowResizeMesh() {
  var standardMesh = document.querySelector("#standard-mesh");
  var curvedMesh = document.querySelector("#curved-mesh");
  const docW = window.innerWidth;
  const docH = window.innerHeight;
  if (docW/docH > 1024/768) {
    standardMesh.style.width = "50%";
    standardMesh.style.float = "left";

    const standardIFrame = standardMesh.querySelector("iframe");
    var w = standardMesh.clientWidth * 0.9;
    if (w > standardIFrame.clientWidth) {
      const h = standardIFrame.clientHeight / standardIFrame.clientWidth * w;
      standardIFrame.style.width = w;
      standardIFrame.style.height = h;
    }

    curvedMesh.style.width = "50%";
    curvedMesh.style.float = "left";
    curvedMesh.style["margin-top"] = "0";

    const curvedIFrame = curvedMesh.querySelector("iframe");
    w = curvedMesh.clientWidth * 0.9;
    if (w > curvedIFrame.clientWidth) {
      const h = curvedIFrame.clientHeight / curvedIFrame.clientWidth * w;
      curvedIFrame.style.width = w;
      curvedIFrame.style.height = h;
    }
  } else {
    standardMesh.style.width = "";
    standardMesh.style.float = "";
    curvedMesh.style.width = "";
    curvedMesh.style.float = "";
    curvedMesh.style["margin-top"] = "1em";
  }
}

function handleWindowMsg() {
  window.addEventListener("message", function(e){
    const splitted = e.source.location.pathname.split("/");
    const base = splitted[splitted.length-1];
    if (base == "standard.html") {
      const standard = document.querySelector("#standard");
      fullscreenIFrame(standard, standard);
    } else if (base == "curved.html") {
      const curved = document.querySelector("#curved");
      fullscreenIFrame(curved, curved);
    } else if (base == "standard_mesh.html") {
      const standard_mesh = document.querySelector("#standard-mesh iframe");
      fullscreenIFrame(standard_mesh, standard_mesh);
    } else if (base == "curved_mesh.html") {
      const curved_mesh = document.querySelector("#curved-mesh iframe");
      fullscreenIFrame(curved_mesh, curved_mesh);
    } else if (base == "standard_stream.html") {
      const standard_stream = document.querySelector("#standard-stream");
      fullscreenIFrame(standard_stream, standard_stream);
    } else if (base == "curved_stream.html") {
      const curved_stream = document.querySelector("#curved-stream");
      fullscreenIFrame(curved_stream, curved_stream);
    }
  });
}

function main() {
  onWindowResizeContainer();
  var imgEl = document.querySelector("#img");
  imgEl.addEventListener("load", function(e){
    onWindowResizeImg();
  });
  onWindowResizeMesh();
  onWindowResizeCFD("#standard");
  onWindowResizeCFD("#curved");
  onWindowResizeCFD("#standard-stream");
  onWindowResizeCFD("#curved-stream");
  handleWindowMsg();
}
main();
    </script>
  </body>
</html>
